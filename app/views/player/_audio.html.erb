<!--suppress HtmlUnknownAttribute -->
<%# should match app/assets/stylesheets/application.scss %>
<audio width="100%" height="40px" class="mejs__player" controls>
  <% hls_id = "source-hls-#{index}" %>
  <source id="<%= hls_id %>" src="<%= track.hls_uri %>" type="<%= AV::Track::SOURCE_TYPE_HLS %>"/>
  <%= javascript_tag do -%>
    // EZProxy shenanigans
    src_orig = $('#<%= hls_id %>').attr('src');
    src_safe = src_orig.replace(/vm147-lib-berkeley-edu\.libproxy.*\.berkeley\.edu/, 'vm147.lib.berkeley.edu');
    $('#<%= hls_id %>').attr('src', src_safe);
  <% end -%>
</audio>
